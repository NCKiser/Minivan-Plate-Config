<html>
  <head>
    <title>MiniVanPlate.xyz</title>
    <link rel="stylesheet" href="stylesheet.css">
  </head>
  <body>
    <label for="Layout">Choose a PCB/Layout:</label>

    <select name="Layout" id="Layout" onchange="dropdown_update()">
      <option value="Asymptote_Universal">Asymptote Universal</option>
      <option value="Asymptote">&emsp;Asymptote Standard</option>
      <option value="Asymptote_700">&emsp;Asymptote 7u Plate-Mount</option>
      <option value="JetVan">JetVan</option>
      <option value="Ketch">Ketch</option>
      <option value="m3n3van_Rev2">m3n3van (Rev2)</option>
      <option value="Minibaen">Minibaen (Rev2)</option>
      <option value="Minisub">Minisub Universal</option>
      <option value="JetVan">&emsp;Minisub 6.25 (JetVan)</option>
      <option value="Minisub_275_225">&emsp;Minisub Split Bars</option>
      <option value="MiniVan_Universal">MiniVan Universal</option>
      <option value="MiniVan_Standard">&emsp;MiniVan Standard</option>
      <option value="MiniVan_Southpaw">&emsp;MiniVan Southpaw</option>
      <option value="MiniVan_Arrows">&emsp;MiniVan Arrows</option>
      <option value="MiniVan_Southpaw_Arrows">&emsp;MiniVan Southpaw + Arrows</option>
      <option value="Monorail_Universal">Monorail Universal</option>
      <option value="MiniVan_Universal">&emsp;Monorail Diesel (MiniVan Universal)</option>
      <option value="Monorail_Steam">&emsp;Monorail Steam</option>
      <option value="Minisub">&emsp;Monorail Jet (Minisub)</option>
    </select>

    <br>

    <label for="Case">Choose a Mount/Case:</label>

    <select name="Case" id="Case" onchange="dropdown_update()">
      
      <option value="Tray">Tray-Mount</option>
      <option value="Tray">&emsp;PCrack (Tray)</option>
      <option value="Tray">&emsp;Plastic MiniVan (Tray)</option>
      <option value="Tray">&emsp;MFR (Tray)</option>
      <option value="Hull">Hull-Mount</option>
      <option value="Hull">&emsp;Dinghy (Hull)</option>
      <option value="Hull">&emsp;Knuckhull (Hull)</option>
      <option value="Hull">&emsp;Pomelo (Hull)</option>
      <option value="Hull">&emsp;Carpool (Hull)</option>
      <option value="Coriander">Coriander-Mount</option>
      <option value="Coriander">&emsp;Barca (Coriander)</option>
      <option value="Coriander">&emsp;Pomelo (Coriander)</option>
      <option value="Coriander">&emsp;Carpool (Coriander)</option>
      <option value="Coriander">&emsp;Hubris (Coriander)</option>
      <option value="Campsite">Campsite-Mount</option>
      <option value="Campsite">&emsp;Campsite</option>
      <option value="Campiander">&emsp;Campiander (Campsite + Coriander)</option>
    </select>

    <br>
    <br>

    <div>
      <h4><span id="no-image-preview" style="display: none">No</span> Preview</h4>
      <img id="image-preview" />
    </div>

    <header>
      <a href="all_dxf/" id="Download" class="download"></a>
    </header>

    <br>
    <br>

    <p>Disclaimer: Plate files on MiniVanPlate.xyz do not guarantee PCB and Case compatibility.
    <br>Please check the <a href="https://docs.google.com/spreadsheets/d/1Uy4UFVSBKyFiH-ic7HVXPmtVq5I_d5Kx8xSe_stobGY/edit?usp=sharing">MiniVan Compatibility Matrix</a> for your PCB and Case combination.</p>
    

    </p>
  </body>
  <script>
    function dropdown_update(){
      let layout_sel = document.getElementById("Layout");
      let case_sel = document.getElementById("Case");
      let selection = `${layout_sel.value}_${case_sel.value}.dxf`;
      let dxf_url = `all_dxf/${selection}`;
      console.log(selection);
      if (LinkCheck(dxf_url)===true) {
      //if (true) {
        document.getElementById("Download").setAttribute('href', dxf_url, 'style', "");
        document.getElementById("Download").innerHTML = `<button class="download_enabled">Download ${selection}</button>`;
        document.getElementById('image-preview').setAttribute('src', getPreview(layout_sel.value, case_sel.value));
      } else {
        document.getElementById("Download").setAttribute('href', '/', 'style', 'pointer-events: none;');
        document.getElementById("Download").innerHTML =  `<button class="download_disabled">File Not Available</button>`;
        document.getElementById('image-preview').setAttribute('src', getPreview());
      }
    }

    function LinkCheck(url)
    {
      var http = new XMLHttpRequest();
      http.open('HEAD', url, false);
      http.send();
      console.log(http.status!=404)
      return http.status!=404;
    }

    function getPreview(layout_sel, case_sel){
      if (layout_sel && case_sel) {
        document.getElementById('image-preview').style.display = '';
        document.getElementById('no-image-preview').style.display = 'none';
        let selection = `all_preview/${layout_sel}_${case_sel}.png`
        return LinkCheck(selection) ? selection : 'https://placehold.co/800x200/white/grey?text=No Preview Available';
      } else {
        document.getElementById('image-preview').style.display = 'none';
        document.getElementById('no-image-preview').style.display = '';
      }
    }

    dropdown_update()
  </script>
</html>